<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Iterator Interface · Pseudo Arc Length Continuation in Julia</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Pseudo Arc Length Continuation in Julia</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials1/">1/ Temperature model</a></li><li><a class="tocitem" href="../tutorials1b/">2/ Temperature model with Spectral Collocation</a></li><li><a class="tocitem" href="../tutorials2/">3/ Swift-Hohenberg</a></li><li><a class="tocitem" href="../tutorials2b/">4/ The Swift-Hohenberg on the GPU (non-local)</a></li><li><a class="tocitem" href="../tutorials3/">5/ Brusselator 1d</a></li><li><a class="tocitem" href="../tutorialsPD/">6/ Period Doubling in BVAM model</a></li><li><a class="tocitem" href="../tutorialsCGL/">7/ Ginzburg-Landau 2d (GPU)</a></li><li><a class="tocitem" href="../tutorialsCGLShoot/">8/ Ginzburg-Landau 2d (Shooting)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Advanced Usage</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../linearsolver/">Linear / Eigen Solvers</a></li><li><a class="tocitem" href="../borderedlinearsolver/">Bordered linear solvers</a></li><li><a class="tocitem" href="../detectionBifurcation/">Bifurcations</a></li><li><a class="tocitem" href="../codim2Continuation/">Fold / Hopf Continuation</a></li><li><a class="tocitem" href="../deflatedproblem/">Deflated problem</a></li><li><a class="tocitem" href="../constrainedproblem/">Constrained problem</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Periodic Orbits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../periodicOrbit/">Introduction</a></li><li><a class="tocitem" href="../periodicOrbitFD/">Finite Differences</a></li><li><a class="tocitem" href="../periodicOrbitShooting/">Shooting</a></li></ul></li><li><a class="tocitem" href="../diffeq/">DiffEq wrapper</a></li><li><a class="tocitem" href="../Borderedarrays/">Bordered arrays</a></li><li class="is-active"><a class="tocitem" href>Iterator Interface</a><ul class="internal"><li><a class="tocitem" href="#Initialization-1"><span>Initialization</span></a></li><li><a class="tocitem" href="#Stepping-1"><span>Stepping</span></a></li><li><a class="tocitem" href="#Example-1"><span>Example</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../faq/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Advanced Usage</a></li><li class="is-active"><a href>Iterator Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Iterator Interface</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rveltz/PseudoArcLengthContinuation.jl/blob/master/docs/src/iterator.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Iterator-Interface-1"><a class="docs-heading-anchor" href="#Iterator-Interface-1">Iterator Interface</a><a class="docs-heading-anchor-permalink" href="#Iterator-Interface-1" title="Permalink"></a></h1><p>The iterator interface gives the possibility of stepping through the numerical steps of the continuation procedure. It thus allows to inject custom monitoring function (saving, plotting, bifurcation detection, ...) at will and during the continuation run. In short, it allows to completely re-write the continuation algorithm as one sees fit and this, in a straightforward manner.</p><p>The general method <code>continuation</code> is built upon this iterator interface and we refer to the source code for a complete example of use.</p><h2 id="Initialization-1"><a class="docs-heading-anchor" href="#Initialization-1">Initialization</a><a class="docs-heading-anchor-permalink" href="#Initialization-1" title="Permalink"></a></h2><blockquote><p>More information about <strong>iterators</strong> can be found on the <a href="https://docs.julialang.org/en/v1/base/collections/#Collections-and-Data-Structures-1">page</a> of <a href="https://docs.julialang.org/en/v1/">julialang</a>.</p></blockquote><p>The interface is set by defining an iterator, pretty much in the same way one calls <a href="../library/#PseudoArcLengthContinuation.continuation"><code>continuation</code></a>:</p><pre><code class="language-julia">iter = PALCIterable(F, J, x0, p0, opts; kwargs...)</code></pre><h2 id="Stepping-1"><a class="docs-heading-anchor" href="#Stepping-1">Stepping</a><a class="docs-heading-anchor-permalink" href="#Stepping-1" title="Permalink"></a></h2><p>Once an iterator <code>iter</code> has been defined, one can step through the numerical continuation using a for loop:</p><pre><code class="language-julia">for state in iter
	println(&quot;Continuation step = &quot;, state.step)
end</code></pre><p>The <code>state::PALCStateVariables</code> has the following description. It is a mutable object which holds the current state of the continuation procedure from which one can step to the next state.</p><p>The for loop stops when <code>done(iter, state)</code> returns <code>false</code>. The condition which is implemented is basically that the number of iterations should be smaller than <code>maxIter</code>, that the parameters should be in <code>(pMin, pMax)</code>...</p><article class="docstring"><header><a class="docstring-binding" id="PseudoArcLengthContinuation.PALCStateVariables" href="#PseudoArcLengthContinuation.PALCStateVariables"><code>PseudoArcLengthContinuation.PALCStateVariables</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">state = PALCStateVariables(ds = 1e-4,...)</code></pre><p>Returns a variable containing the state of the continuation procedure.</p><p><strong>Arguments</strong></p><ul><li><code>z_pred</code> current solution on the branch</li><li><code>tau</code> tangent predictor</li><li><code>z_old</code> previous solution</li><li><code>isconverged</code> Boolean for newton correction</li><li><code>itnewton</code> Number of newton iteration (in corrector)</li><li><code>step</code> current continuation step</li><li><code>ds</code> step size</li><li><code>theta</code> theta parameter for constraint equation in PALC</li><li><code>stopcontinuation</code> Boolean to stop continuation</li></ul><p><strong>Useful functions</strong></p><ul><li><code>copy(state)</code> returns a copy of <code>state</code></li><li><code>solution(state)</code> returns the current solution (x, p)</li><li><code>getx(state)</code> returns the x component of the current solution</li><li><code>getp(state)</code> returns the p component of the current solution</li><li><code>isstable(state)</code> whether the current solution is linearly stable</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/2d5741174ce3e6a394010d2e470e4269ca54607f/base/#L0-L22">source</a></section></article><div class="admonition is-success"><header class="admonition-header">continuation</header><div class="admonition-body"><p>You can also call <code>continuation(iter)</code> to have access to the regular continuation method used throughout the tutorials.</p></div></div><h2 id="Example-1"><a class="docs-heading-anchor" href="#Example-1">Example</a><a class="docs-heading-anchor-permalink" href="#Example-1" title="Permalink"></a></h2><p>We show a quick and simple example of use. Note that it is not very optimized because of the use of global variables.</p><pre><code class="language-julia">using PseudoArcLengthContinuation, SparseArrays, LinearAlgebra, Plots, Setfield
const PALC = PseudoArcLengthContinuation

# define a norm
normInf = x -&gt; norm(x, Inf)

k = 2

# functional we want to study
F = (x, p) -&gt; (@. p + x - x^(k+1)/(k+1))

# Jacobian for the fonctional
Jac_m = (x, p) -&gt; diagm(0 =&gt; 1  .- x.^k)


# parameters for the continuation
opts = PALC.ContinuationPar(dsmax = 0.1, dsmin = 1e-3, ds = -0.001, maxSteps = 130, pMin = -3., pMax = 3., saveSolEveryNsteps = 0, computeEigenValues = true, detectBifurcation = true, newtonOptions = NewtonPar(tol = 1e-8, verbose = true))

# we define an iterator to hold the continuation routine
iter = PALC.PALCIterable(F, Jac_m, [0.8], 1., opts; verbosity = 2)

resp = Float64[]
resx = Float64[]

# this is the PALC algorithm
for state in iter
	# we save the current solution on the branch
	push!(resx, getx(state)[1])
	push!(resp, getp(state))
end

# plot the result
plot(resp, resx; label = &quot;&quot;, xlabel = &quot;p&quot;)</code></pre><p>and you should see:</p><p><img src="../iterator.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Borderedarrays/">« Bordered arrays</a><a class="docs-footer-nextpage" href="../faq/">Frequently Asked Questions »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 29 March 2020 21:48">Sunday 29 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
